# 3**ì¼ì°¨ - 4ì›” 7ì¼**

### **ì˜¤ëŠ˜ì˜ ì—­í• ë°°ì •**

ë„¤ë¹„ê²Œì´í„° : ì´ì€ì´ / ë“œë¼ì´ë²„ : ê¹€ìœ¤ì„œ / ì •ë¦¬ : ì¡°ì€ì§€

------

## :memo: TO DO 

1. ê¶Œí•œ ì œí•œ 
2. static, media êµ¬í˜„ 
3. 1:N ëŒ“ê¸€ ê¸°ëŠ¥ 

<hr>

### ğŸ’œ 1. ê¶Œí•œ ì œí•œ

update, delete ê¸€ ì‘ì„±ì ë³¸ì¸ë§Œ ê°€ëŠ¥í•˜ë„ë¡ ì œí•œ

### **âš ï¸ ì‚¬ì¹­**

formì—ì„œ user ì…ë ¥ì„ excludeí•˜ì§€ ì•Šì•„ ì‚¬ì¹­ì´ ê°€ëŠ¥í–ˆìŒ

(ë³¸ì¸ì´ ì“´ ê¸€ì¸ë°ë„ ë‹¤ë¥¸ ìœ ì €ê°€ ì“´ ê¸€ë¡œ ì¸ì‹ë˜ì–´ ì‚­ì œë„ ë¶ˆê°€)

â†’ Q. like_users ì‚¬ì¹­ì€ ì™œ ì•ˆë˜ëŠ”ì§€? ë‹¤ìŒ ì‹œê°„ì— í™•ì¸í•´ë³¼ ê²ƒ

### **âš ï¸ ë“¤ì—¬ì“°ê¸°**

```python
@login_required
@require_http_methods(['GET', 'POST'])
def update(request, article_pk):
    article = get_object_or_404(Article, pk=article_pk)
    if request.user == article.user:
        if request.method == 'POST':
            form = ArticleForm(request.POST, request.FILES, instance=article)
            if form.is_valid():
                form.save()
                return redirect('articles:detail', article_pk)
        else:
            form = ArticleForm(instance=article)
    else:
        return redirect('articles:detail', article_pk)    
    context = {
        'form': form,
        'article': article,
    }
    return render(request, 'articles/update.html', context)
```

ì²«ë²ˆì§¸ ifë¬¸ì˜ elseê°€ í•„ìš”í•œê°€ ì§ˆë¬¸ì´ ìˆì—ˆìŒ

â†’ ì—†ì„ ê²½ìš°  ë‘ë²ˆì§¸ ifë¬¸ì—ì„œ elseë¡œ ë‚˜ì˜¨ ê²½ìš° ë§¨ ì•„ë˜ renderë¡œ ê°€ì§€ ëª»í•˜ê³  redirect ë˜ê¸° ë•Œë¬¸ì— else ì²˜ë¦¬ í•„ìš”í•¨

### **âš ï¸ ìì£¼ ë§Œë‚˜ëŠ” IntegreityError**

![img](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/fb7d5a07-de91-49e2-806f-709ef5fb2a9e/111.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210408%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20210408T020102Z&X-Amz-Expires=86400&X-Amz-Signature=a9e3cf7bf24304b0d9b5f5ff1afc0c3a10617217d60b1276a0a4229d6e487c3c&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22111.png%22)

Article : User 1:N ê´€ê³„ ì„¤ì • ì•ˆí•´ì„œ article.user ì—†ì—ˆìŒ â†’ 1:N ê´€ê³„ ì„¤ì • ë¨¼ì € í•¨

ì´í›„ form.save()ì— commit=False ì²˜ë¦¬í•˜ê³  user ë„£ì–´ì£¼ëŠ” ë¶€ë¶„ì„ ì•ˆí•´ì„œ ì—ëŸ¬

```python
@login_required
@require_http_methods(['GET', 'POST'])
def create(request):
    if request.method == 'POST':
        form = ArticleForm(request.POST, request.FILES)
        if form.is_valid():
            article = form.save(commit=False)
            article.user = request.user
            article.save()
            return redirect('articles:index')
    ...
```



<hr>

### ğŸ’œ 2. static/media

ìš°ë‹¹íƒ•íƒ•.. ê¸°ì¡´ ìë£Œë¥¼ ë§ì´ ì°¸ê³ í•´ì„œ êµ¬í˜„í•œ ë¶€ë¶„

ì²˜ìŒ ëª¨ë¸ë§ì„ í•˜ë©´ì„œ ImageField ë“±ì€ í•´ë†“ì•˜ëŠ”ë°ë„ ì´ì²´ì  ë‚œêµ­ì˜ staticê³¼ media êµ¬í˜„..

## **âš ï¸ ì—‘ë°•/ì—ëŸ¬ í•´ê²°í•˜ê¸°**

### 1. ì—‘ë°•

ì´ë¯¸ì§€ë¥¼ ë°›ì•„ì„œ ì²˜ë¦¬í•˜ê³  ìˆì§€ ì•Šì•˜ìŒ

request.POSTë§Œ ë°›ê³  request.FILESë¥¼ ë°›ê³  ìˆì§€ ì•Šì•„ì„œ ìˆ˜ì •

### 2. ì—ëŸ¬

![img](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/62b9fdca-6f30-406d-bd91-2d9fd5516617/222.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210408%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20210408T020212Z&X-Amz-Expires=86400&X-Amz-Signature=e77676752e4ad6214a402e76cddaf9c397fc13defce33ecbb617deb78ce9913b&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22222.png%22)

ì¸ë±ìŠ¤ í˜ì´ì§€ì— article.imageë¥¼ ë°”ë¡œ ì‚¬ìš©í•˜ê³  ìˆì—ˆëŠ”ë° ì´ë¯¸ì§€ê°€ ì—†ëŠ” ê²Œì‹œê¸€ë„ ìˆì—ˆê¸° ë•Œë¬¸ì— ë°œìƒí•˜ëŠ” ì—ëŸ¬ì˜€ìŒ

ifë¬¸ìœ¼ë¡œ ì´ë¯¸ì§€ê°€ ìˆëŠ” ê²½ìš°ì™€ ì—†ëŠ” ê²½ìš° ë‚˜ëˆ ì„œ ìˆ˜ì •

### 3. ì—‘ë°• ë˜ ë‚¨

```python
from django.conf import settings
from django.conf.urls.static import static

urlpatterns = [
	... 
] + static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
```

ì´ê±° ì•ˆí–‡ìŒ...ã… 

í•­ìƒ django ê³µì‹ ë¬¸ì„œë¥¼ ì˜ ì°¸ê³ í•˜ëŠ” ìŠµê´€ì„ ê°€ì§€ì! 



### 4. ìŠ¤íƒœí‹± ë„ì „ â†’ ì—‘ë°•^^

base.htmlì— ì´ë¯¸ì§€ë¥¼ ë„£ê³  ì‹¶ì—ˆëŠ”ë° ë°°ìš´ëŒ€ë¡œë§Œ í•˜ë‹¤ë³´ë‹ˆ articles ì•±ì— static í´ë”ë¥¼ ë§Œë“¤ì—ˆìŒ

í”„ë¡œì íŠ¸ í´ë” ì•ˆì— static í´ë”ë¥¼ ìƒì„±í•´ì„œ í•´ê²°!

![img](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/28359426-9ebd-416d-845e-18ac910e8811/444.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210408%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20210408T020250Z&X-Amz-Expires=86400&X-Amz-Signature=5449bf22282b5715c68a45e740f457d990b7cf44eef5f0a214233480f3ba48f4&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22444.png%22)

<hr>

### ğŸ’œ 3. Comment ëª¨ë¸ ìƒì„±, Articleê³¼ ì—°ê²°

íŠ¹ë³„í•œ ì´ìŠˆ ì—†ì´ ë¬´ë‚œí•˜ì˜€ìŠµë‹ˆë‹¤..

```python
def comment_create(request, article_pk):
    article = get_object_or_404(Article, pk=article_pk)
    comment_form = CommentForm(request.POST)
    if comment_form.is_valid():
        ...
    context = {
        'article': article,
        'comment_form': comment_form,
    }
    return render(request, 'articles/detail.html', context)
```

ê¹¨ë—í•œ í™”ì§ˆì„ ì°¾ì•„ ì›¹ì—‘ìŠ¤ë¡œ ì´ì‚¬ì˜¨ í™”ë©´ì„ ì—¬ê¸° ì˜¬ë¦¬ê² ìŠµë‹ˆë‹¤ ^0^ ì—´ì¼í•˜ëŠ” ìš°ë¦¬íŒ€

![img](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/f1dfa935-3474-488d-be95-455f3543c2c8/333.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210408%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20210408T020400Z&X-Amz-Expires=86400&X-Amz-Signature=0af9f796ecefc5719f79c648e0f0db2ff8d8d41f2887e7cae5af82988bda59f5&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22333.png%22)



<hr>

### ğŸ’œToday I learned 

- ì—­ì‹œ ë“œë¼ì´ë²„ëŠ” ì–´ë µë‹¤.. ë”êµ°ë‹¤ë‚˜ ì˜ ëª¨ë¥´ëŠ” static/media íŒŒíŠ¸ë¥¼ ê±°ì˜ ëª¨ë¥´ëŠ” ìƒíƒœì—ì„œ ë„¤ë¹„ê²Œì´í„°ë„ ì•„ë‹ˆê³  ë“œë¼ì´ë²„ë¥¼ í•˜ë ¤ë‹ˆ ë¨¸ë¦¬í„°ì§! ã…  
- ê·¼ë° í™•ì‹¤íˆ ìˆ˜ì—…í•œ ì§€ ì¢€ ì§€ë‚˜ê³  ì½”ë“œ ì•ˆë³´ê³  ë³µìŠµì„ í•´ë³´ë‹ˆê¹Œ ë” ë¨¸ë¦¬ì— ì˜ ì €ì¥ë˜ëŠ” ê²ƒ ê°™ë‹¤~~ 
- ì´ì œ ê¸°ëŠ¥ êµ¬í˜„ì€ ê±°ì˜ ë‹¤ ë§ˆë¬´ë¦¬ ë˜ì–´ê°€ì„œ ë‹¤ìŒ ì˜¤í”„ë¼ì¸ ë§Œë‚¨ì´ ê¸°ëŒ€ëœë‹¤ :) 

